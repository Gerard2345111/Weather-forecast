<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#4facfe">
  <meta charset="UTF-8">
  <title>Advanced Weather App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    * {
      box-sizing: border-box;
      font-family: "Segoe UI", sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: linear-gradient(to right,#4facfe,#00f2fe);
      transition: 0.4s;
    }

    body.dark {
      background: linear-gradient(to right,#020617,#1e293b);
      color: white;
    }

    .app {
      width: 100%;
      max-width: 420px;
      padding: 20px;
      border-radius: 20px;
      background: rgba(255,255,255,0.25);
      backdrop-filter: blur(15px);
      box-shadow: 0 20px 40px rgba(0,0,0,0.3);
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }

    /* Profile Picture */
    .profile {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      overflow: hidden;
      border: 2px solid white;
    }

    .profile img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .header-buttons button {
      margin-left: 5px;
    }

    button {
      border: none;
      border-radius: 8px;
      padding: 8px 12px;
      cursor: pointer;
      transition: 0.2s;
    }

    button:hover {
      transform: scale(1.05);
    }

    .search-box {
      display: flex;
      gap: 8px;
      margin: 15px 0;
    }

    .search-box input {
      flex: 1;
      padding: 10px;
      border-radius: 8px;
      border: none;
    }

    .location-btn {
      width: 100%;
      background: #0ea5e9;
      color: white;
      margin-bottom: 10px;
    }

    .time-box {
      text-align: center;
      font-size: 14px;
      margin-bottom: 8px;
    }

    .alert-box {
      display: none;
      padding: 10px;
      border-radius: 10px;
      font-size: 13px;
      text-align: center;
      margin-bottom: 10px;
    }

    .alert-hot { background: #f97316; color: white; }
    .alert-rain { background: #3b82f6; color: white; }
    .alert-storm { background: #7c3aed; color: white; }
    .alert-cold { background: #0ea5e9; color: white; }

    .loader {
      display: none;
      width: 40px;
      height: 40px;
      border: 4px solid #ccc;
      border-top: 4px solid #0284c7;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 15px auto;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .weather-card {
      text-align: center;
    }

    .weather-card img {
      width: 80px;
    }

    .temp {
      font-size: 52px;
      font-weight: bold;
    }

    .info-grid {
      display: grid;
      grid-template-columns: repeat(2,1fr);
      gap: 10px;
      margin-top: 10px;
    }

    .info-grid div {
      background: rgba(255,255,255,0.35);
      padding: 10px;
      border-radius: 12px;
      font-size: 13px;
      text-align: center;
    }

    .section-title {
      margin-top: 20px;
      font-size: 15px;
    }

    .hourly {
      display: flex;
      gap: 10px;
      overflow-x: auto;
    }

    .hourly div {
      min-width: 70px;
      background: rgba(255,255,255,0.35);
      padding: 8px;
      border-radius: 12px;
      font-size: 12px;
      text-align: center;
    }

    .forecast {
      display: grid;
      grid-template-columns: repeat(5,1fr);
      gap: 6px;
      margin-top: 10px;
    }

    .forecast div {
      background: rgba(255,255,255,0.35);
      padding: 8px;
      border-radius: 10px;
      font-size: 12px;
      text-align: center;
    }
  </style>
</head>

<body>

<div class="app">
  <header>
    <!-- Profile Picture -->
    <div class="profile">
      <!-- Replace the image URL with your own picture -->
      <img src="https://i.pinimg.com/736x/11/69/6a/11696a79c0895e164359cbab5c3073b5.jpg" alt="Profile">
    </div>

    <h1>üå§ Weather</h1>

    <div class="header-buttons">
      <button id="toggleTheme">üåô</button>
      <button onclick="refreshWeather()">üîÑ</button>
      <button onclick="toggleUnit()">üå°</button>
    </div>
  </header>

  <div class="search-box">
    <input type="text" id="cityInput" placeholder="Search city">
    <button onclick="searchCity()">Search</button>
  </div>

  <button class="location-btn" onclick="useLocation()">üìç My Location</button>

  <div id="timeBox" class="time-box"></div>
  <div id="alertBox" class="alert-box"></div>
  <div class="loader" id="loader"></div>

  <div id="currentWeather"></div>
  <div id="extraInfo" class="info-grid"></div>

  <h3 class="section-title">üïí Hourly Forecast</h3>
  <div id="hourlyForecast" class="hourly"></div>

  <canvas id="tempChart"></canvas>

  <h3 class="section-title">üìÖ 5-Day Forecast</h3>
  <div id="forecast"></div>
</div>

<script>
  const apiKey = "085fa26c05d59d28da9e0131a6c35c3c";
  let unit = "metric";
  let lastCity = "";
  let chart;

  const loader = document.getElementById("loader");
  const currentWeather = document.getElementById("currentWeather");
  const forecastDiv = document.getElementById("forecast");
  const hourlyDiv = document.getElementById("hourlyForecast");
  const alertBox = document.getElementById("alertBox");
  const extraInfo = document.getElementById("extraInfo");

  document.getElementById("toggleTheme").onclick = () =>
    document.body.classList.toggle("dark");

  function showLoader(v){ loader.style.display = v ? "block" : "none"; }

  function updateTime(){
    const now = new Date();
    document.getElementById("timeBox").innerHTML =
      `<strong>${now.toLocaleTimeString()}</strong><br>${now.toDateString()}`;
  }
  setInterval(updateTime,1000);
  updateTime();

  function searchCity(){
    const city = cityInput.value;
    if(!city) return;
    lastCity = city;
    fetchWeather(city);
  }

  function refreshWeather(){
    if(lastCity) fetchWeather(lastCity);
  }

  function toggleUnit(){
    unit = unit === "metric" ? "imperial" : "metric";
    if(lastCity) fetchWeather(lastCity);
  }

  function useLocation(){
    navigator.geolocation.getCurrentPosition(pos=>{
      fetchWeatherByCoords(pos.coords.latitude,pos.coords.longitude);
    });
  }

  function fetchWeather(city){
    showLoader(true);
    fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&units=${unit}&appid=${apiKey}`)
      .then(r=>r.json())
      .then(d=>{
        showLoader(false);
        displayCurrent(d);
        fetchForecast(city);
        showAlert(d);
      });
  }

  function fetchWeatherByCoords(lat,lon){
    showLoader(true);
    fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=${unit}&appid=${apiKey}`)
      .then(r=>r.json())
      .then(d=>{
        showLoader(false);
        lastCity = d.name;
        displayCurrent(d);
        fetchForecast(d.name);
        showAlert(d);
      });
  }

  function fetchForecast(city){
    fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${city}&units=${unit}&appid=${apiKey}`)
      .then(r=>r.json())
      .then(data=>{
        hourlyDiv.innerHTML = data.list.slice(0,8).map(h=>`
          <div>
            ${new Date(h.dt_txt).getHours()}:00<br>
            <img src="https://openweathermap.org/img/wn/${h.weather[0].icon}.png">
            ${Math.round(h.main.temp)}¬∞
          </div>`).join("");

        forecastDiv.innerHTML = `
          <div class="forecast">
            ${data.list.filter((_,i)=>i%8===0).slice(0,5).map(d=>`
              <div>
                ${new Date(d.dt_txt).toLocaleDateString("en",{weekday:"short"})}<br>
                <img src="https://openweathermap.org/img/wn/${d.weather[0].icon}.png"><br>
                ${Math.round(d.main.temp)}¬∞
              </div>`).join("")}
          </div>`;

        drawChart(data);
      });
  }

  function drawChart(data){
    const labels = data.list.slice(0,8).map(d=>new Date(d.dt_txt).getHours()+":00");
    const temps = data.list.slice(0,8).map(d=>d.main.temp);

    if(chart) chart.destroy();
    chart = new Chart(tempChart,{
      type:"line",
      data:{ labels, datasets:[{ label:"Temp", data:temps, tension:0.4 }] }
    });
  }

  function displayCurrent(d){
    const icon = d.weather[0].icon;
    currentWeather.innerHTML = `
      <div class="weather-card">
        <h2>${d.name}</h2>
        <img src="https://openweathermap.org/img/wn/${icon}@2x.png">
        <div class="temp">${Math.round(d.main.temp)}¬∞</div>
      </div>`;

    extraInfo.innerHTML = `
      <div>üíß Humidity<br>${d.main.humidity}%</div>
      <div>üí® Wind<br>${d.wind.speed}</div>
      <div>üå° Feels Like<br>${Math.round(d.main.feels_like)}¬∞</div>
      <div>üß≠ Pressure<br>${d.main.pressure}</div>`;
  }

  function showAlert(d){
    alertBox.style.display = "block";
    alertBox.className = "alert-box";

    if(d.main.temp >= 35){
      alertBox.classList.add("alert-hot");
      alertBox.innerHTML = "üî• Heat Alert";
    } else if(d.weather[0].main.includes("Rain")){
      alertBox.classList.add("alert-rain");
      alertBox.innerHTML = "üåß Rain Alert";
    } else {
      alertBox.style.display = "none";
    }
  }
</script>

</body>
</html>